# Core REST Concepts (what they love to ask)

- **REST constraints:** client–server, stateless, cacheable, uniform interface, layered system, (optional) code-on-demand.
- **Resource modeling:** nouns not verbs (`/orders/123/items`), plural collections (`/users`), sub-resources (`/users/42/posts/7`).
- **HTTP methods & semantics:**

  - `GET` – read (safe, idempotent)
  - `POST` – create / non-idempotent action (not idempotent)
  - `PUT` – full replace (idempotent)
  - `PATCH` – partial update (not guaranteed idempotent; often treated as such if same patch)
  - `DELETE` – delete (idempotent)
  - **Safe methods:** don’t change state (`GET`, `HEAD`, `OPTIONS`)
  - **Idempotent:** same request ≥1 time → same result (`GET`, `PUT`, `DELETE`, `HEAD`, `OPTIONS`)

- **Status codes you must know (map to CRUD):**

  - `200 OK` – general success
  - `201 Created` (+ `Location` header) – resource created
  - `202 Accepted` – async accepted
  - `204 No Content` – success, no body (e.g., `DELETE`, `PUT` without response)
  - `301/308` – redirects (permanent; 308 keeps method)
  - `304 Not Modified` – caching / conditional requests
  - `400 Bad Request` – invalid input (validation)
  - `401 Unauthorized` – auth required/invalid (means “Unauthenticated”)
  - `403 Forbidden` – authenticated but not allowed
  - `404 Not Found` – missing resource
  - `405 Method Not Allowed` – wrong verb
  - `409 Conflict` – version/idempotency conflict
  - `415 Unsupported Media Type` – wrong `Content-Type`
  - `422 Unprocessable Entity` – semantic validation failed (popular choice)
  - `429 Too Many Requests` – rate limiting
  - `500/502/503/504` – server/gateway issues

- **URIs & versioning:**

  - Clean URIs: `/customers/123/orders?status=paid&sort=-createdAt`
  - Avoid verbs: ❌`/createUser` → ✅`/users`
  - Versioning: URL (`/v1`), header (`Accept: application/vnd.company.v1+json`), or query (least preferred). URL is simplest; header is cleanest.

- **Filtering, sorting, pagination:**

  - Query params: `?page=2&pageSize=50&sort=-createdAt&status=active`
  - Pagination styles: page/size, cursor/continuation-token.
  - Include pagination metadata (`X-Total-Count` or in body) and HATEOAS links (`next`, `prev`).

- **Content negotiation:**

  - `Accept` (what client wants) vs `Content-Type` (what you send).
  - Prefer JSON; support `application/json`. Consider `application/problem+json` for errors.

- **Errors (RFC 7807 Problem Details):**

  ```json
  {
    "type": "https://example.com/probs/validation",
    "title": "Validation failed",
    "status": 422,
    "detail": "Email is invalid.",
    "instance": "/users",
    "errors": { "email": ["Must be a valid address"] }
  }
  ```

- **Caching & conditional requests:**

  - Response headers: `Cache-Control`, `ETag`, `Last-Modified`, `Expires`
  - Conditional: `If-None-Match` (ETag) → `304`, `If-Match` for optimistic concurrency.

- **Idempotency keys (especially for POST):**

  - Client sends `Idempotency-Key: <uuid>`; server stores result to prevent duplicates.

- **Security basics:**

  - TLS only (https).
  - **AuthN:** Bearer JWT, OAuth 2.0, mTLS (rare in questions).
  - **AuthZ:** scopes/roles; return `403` for insufficient permissions.
  - **CORS:** preflight (`OPTIONS`), `Access-Control-Allow-Origin`, `-Methods`, `-Headers`, credentials rules.
  - Validate inputs; never trust client; avoid overexposing errors.

- **Rate limiting / throttling:**

  - Headers: `Retry-After`, `X-RateLimit-Limit/Remaining/Reset` (or `RateLimit-*` draft).
  - Return `429`.

- **Concurrency control:**

  - **Optimistic:** `ETag` + `If-Match`; on mismatch → `412 Precondition Failed`.

- **File uploads/downloads:**

  - Uploads via `multipart/form-data` or pre-signed URLs (often in cloud contexts).
  - Set `Content-Disposition` for downloads.

- **HATEOAS (they may name-drop):**

  - Provide actionable links:

    ```json
    {
      "id": 7,
      "links": [
        { "rel": "self", "href": "/orders/7" },
        { "rel": "cancel", "href": "/orders/7/cancel" }
      ]
    }
    ```

- **Documentation & contracts:**

  - OpenAPI/Swagger; keep examples; use proper response schemas; avoid breaking changes.

- **Stability & resilience:**

  - Timeouts, retries (with backoff), circuit breakers (Polly in .NET), request correlation (`Trace-Id`).

- **Validation:**

  - Required fields, formats, ranges; return 400/422 with details.

## ASP.NET Core specifics that can sneak into this section

(Even though you’ll have a separate ASP.NET section, they sometimes mix in basics.)

- **Routing:** attribute (`[HttpGet("orders/{id:int}")]`) vs conventional; route constraints.
- **Binding:** `[FromBody]`, `[FromRoute]`, `[FromQuery]`, `[FromHeader]`.
- **Minimal APIs vs Controllers:** `app.MapGet(...)` vs `ApiController`.
- **Validation:** DataAnnotations / FluentValidation → 400 with model state.
- **Exception handling:** Use middleware; map to ProblemDetails.
- **`IHttpClientFactory`** (typed/named clients), resilience with Polly.
- **DTOs vs entities, AutoMapper**, avoid over-posting.
- **ETag in ASP.NET Core:** set `ETag` header and check `If-Match`.

## Quick reference tables

**Methods & properties:**

| Method  | Safe | Idempotent | Typical Use                    |
| ------- | ---- | ---------- | ------------------------------ |
| GET     | ✅   | ✅         | Read resource(s)               |
| HEAD    | ✅   | ✅         | Headers only                   |
| OPTIONS | ✅   | ✅         | Capabilities/preflight         |
| POST    | ❌   | ❌         | Create / non-idempotent action |
| PUT     | ❌   | ✅         | Replace resource               |
| PATCH   | ❌   | ⚠️ Usually | Partial update                 |
| DELETE  | ❌   | ✅         | Remove                         |

**Status code hits:**

- Create: `201 + Location`
- Update (PUT/PATCH): `200` (body) or `204` (no body)
- Delete: `204`
- Not found: `404`
- Duplicate/Version clash: `409` or `412` (with `If-Match`)
- Validation: `400` or `422`
- Too many requests: `429`

**Caching:**

- Strong validator: `ETag: "abc123"`, `If-None-Match: "abc123"` → `304`
- Concurrency: `If-Match: "abc123"` → `412` on mismatch

**CORS:**

- Preflight: `OPTIONS` with `Access-Control-Request-Method/Headers`
- Response must include `Access-Control-Allow-Origin` (exact origin or `*` without creds), `Allow-Methods`, `Allow-Headers`

## Patterns they test with tiny scenarios

- **POST vs PUT for create?**

  - Unknown ID (server generates) → `POST /users`
  - Client provides full representation & known ID → `PUT /users/{id}`

- **Partial update?** `PATCH /resource/{id}` (JSON Patch or merge patch)
- **Bulk operations?** `POST /orders:batchCancel` (action endpoint) or collection sub-resource `/orders/bulk`
- **Sorting by multiple fields:** `?sort=-createdAt,name`
- **Field selection (projection):** `?fields=id,name`
- **Versioning without breaking old clients:** keep old behavior; add new fields; never repurpose fields.

## 12-Question Mock (with concise answers)

1. **Which methods are idempotent?**
   `GET, PUT, DELETE, HEAD, OPTIONS` (PATCH: “it depends”, usually treated non-idempotent)

2. **When to return `201 Created`?**
   After creating a resource; include `Location` header to the new resource.

3. **Difference between `401` and `403`?**
   `401`: not authenticated/invalid token. `403`: authenticated but not authorized.

4. **Best URI for adding an item to cart?**
   `POST /carts/{cartId}/items` (resource, not verb).

5. **How to implement optimistic concurrency?**
   Use `ETag` on GET and `If-Match` on update; return `412` on mismatch.

6. **What’s `PATCH` for?**
   Partial updates (JSON Patch `application/json-patch+json` or merge-patch).

7. **How to avoid duplicate charges on retrying `POST /payments`?**
   Use `Idempotency-Key` header stored server-side → return same result if retried.

8. **Which status for validation errors?**
   `400` (common) or `422` (semantic validation), with ProblemDetails body.

9. **How to deliver pagination?**
   `page`/`pageSize` or cursor tokens; include `next/prev` links and/or counts.

10. **What does `Accept` control vs `Content-Type`?**
    `Accept`: what client can receive. `Content-Type`: what server sends (and what client sends in request body).

11. **When do you return `204 No Content`?**
    Successful operation with no response body (e.g., `DELETE`, some `PUT/PATCH`).

12. **What triggers a CORS preflight?**
    Cross-origin request with non-simple method/headers; browser sends `OPTIONS` preflight.

---

If you want, I can turn this into rapid-fire flashcards or a 10-minute drill. Ready to move to the next section (**ASP.NET (incl. ASP.NET Core)**), or want mini practice questions just for REST first?
